# pull
                                        Описание процесса ETL

На шаге From Flight получаем данные о перелетах, затем к эти данным добавляем столбец с текущей датой на шаге Add Now Date после чего на шаге Now Date отфильтровываем те перелеты где дата вылета или дата прилета больше или равна текущей дате, ошибочные данные пишем в таблицу err_aircraft. 
Дале проверяем на наличие записей где дата вылета больше даты прилета и так же записываем ошибочные данные в таблицу err_aircraft. 
На шаге Diff Departure рассчитываем разницу между планируемой и фактической датой вылета
На шаге Diff Arrival рассчитываем разницу между планируемой и фактической датой прилета
На шаге Select values обираем только нужные нам столбцы
На шаге Filter Aircraft отфильтровываем те записи где нет кода самолета. Ошибочные данные пишем в таблицу err_aircraft
Передаем данные для объединения с данными из таблицы Aircrafts из шага From Aircrafts, предварительно отфильтрованными на пустые строки по модели судна.
На шаге Update Aircrafts обновляем справочник Dim_Aircrafts и добавляем поле model в наши данные
На шаге Add Departure добавляем данные из таблицы Airports для подстановки названия аэропорта отправления
  На шаге Add Arrival добавляем данные из таблицы Airports для подстановки названия аэропорта прибытия
На шаге Update Airports добавляем данные в таблицу Dim_Airports  и заменяем поля Airports_name на id из справочной таблицы для аэропорта отправления
На шаге Update Airports Des добавляем данные в таблицу Dim_Airports  и заменяем поля Airports_name на id из справочной таблицы для аэропорта прибытия.
На шаге From ticket_flights получаем данные из таблицы ticket_flights 
На шаге From Tickets получаем данные из таблицы tickets
На шаге Add Flight_id  объединяем данные из шагов From ticket_flights и From Tickets для получения flight_id
На шаге Add_Boarding_no объединяем данные с данными из таблицы boarding_pass для получения номера посадочного
На шаге Filter boarding отбираем пассажиров с посадочными талонами, без посадочных отправляем в таблицу err_passinger
На шаге Filter Conditions отбираем пассажиров с классом обслуживания, без класса в таблицу err_passinger
На шаге Filter Amount отбираем пассажиров с непустым платежом и платежом больше 0, ошибочных в таблицу err_passinger
На шаге Add Flights объединяем пассажиров и перелеты
На шаге Filter DEP отбираем пассажиров с наличем актуальной даты вылета, без отправляем в таблицу err_flight
На шаге Filter ARR отбираем пассажиров с актуальной датой прилета, без отправляем в таблицу err_flight
На шаге Update Tariff обновляем справочник Dim_Tariff куда заносим номер рейса,  класс обслуживания и платеж, заменям эти данные в потоке на id из справочника
На шаге Combination lookup/update заполняем справочник Dim_Passengers, куда заносим его id и имя, заменяем эти данные в потоке на id из справочника
На шаге Select values 2 выбираем только нужные нам столбцы и приводим данные к нужному типу.
На шаге Update Fact добавляем данные в таблицу Fact_Flights.
 
 

